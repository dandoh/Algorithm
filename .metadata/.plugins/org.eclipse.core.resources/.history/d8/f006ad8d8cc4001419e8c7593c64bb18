
public class KdTree {
	private static boolean X = true;
	private int size;
	private Node root;
	
	public KdTree() {
		root = null;
		size = 0;
	}
	public boolean isEmpty() { return size == 0; }
	public int size() { return size; }
	public void insert(Point2D p) {
		root = insert(root, null, p, X, true);
	}
	
	private boolean goLeft(Point2D stay, Point2D key, boolean align) {
		if (align == X) {
			return key.x() < stay.x();
		} else {
			return key.y() < stay.y();
		}
	}
	
	private Node insert(Node parent, Node node, Point2D p, boolean align, boolean less) {
		if (node == null) 
			return new Node(parent, p, align, less);
		
		if (p.equals(node.p)) return node;
		
		if (goLeft(node.p, p, align)) 
			node.left = insert(node, node.left, p, !align, true);
		else
			node.right = insert(node, node.right, p, !align, false);
		
		return node;
	}
	public boolean contains(Point2D p) {
		return contains(root, p);
	}
	
	private boolean contains(Node node, Point2D p) {
		if (node == null) return false;
		
		if (p.equals(node.p)) return true;
		
		if (goLeft(node.p, p, node.align)) {
			return contains(node.left, p);
		} else {
			return contains(node.right, p);
		}
		
	}
	
	private Iterable<Node> set() {
		Queue<Node> queue = new Queue<Node>();
		add(root, queue);
		
		return queue;
	}
	
	private void add(Node node, Queue<Node> queue) {
		if (node == null) return;
		queue.enqueue(node);
		add(node, queue);
		add(node, queue);
	}
	
	public void draw() {
		StdDraw.setPenRadius(.01);
		for (Node node : set()) {
			node.p.draw();
		}
		StdDraw.setPenRadius();
	}
	//public Iterable<Point2D> range(RectHV rect) {}
	
	public static void main(String[] args) {
		KdTree tree = new KdTree();
		
		for (int i = 0; i < 20; i++) {
			double x = StdRandom.random();
			double y = StdRandom.random();
						
			tree.insert(new Point2D(x, y));
		}
        
		tree.draw();
	}
	
	private static class Node {
		public Node(Node parent, Point2D p, boolean align, boolean less) {
			this.parent = parent;
			this.p = p;
			this.align = align;
			this.parent = parent;
			if (parent == null)
				rect = new RectHV(0, 0, 1, 1);
			
			if (align == X) {
				if (less) {
					rect = new RectHV(parent.rect.xmin(), parent.rect.ymin(), parent.rect.xmax(), parent.p.y());
				} else {
					rect = new RectHV(parent.rect.xmin(), parent.p.y(), parent.rect.xmax(), parent.rect.ymax());
				}
			} else {
				if (less) {
					rect = new RectHV(parent.rect.xmin(), parent.rect.ymin(), parent.p.x(), parent.rect.ymax());
				} else {
					rect = new RectHV(parent.p.x(), parent.rect.ymin(), parent.rect.xmax(), parent.rect.ymax());
				}
			}
			
		}
		private Point2D p;
		private boolean align;
		private Node parent;
		private Node left;
		private Node right;
		private RectHV rect;
	}
}
